# 역할, 책임, 협력

이번 장의 시작에서 객체의 행동 방식을 결정하는 것은 협력임을 강조한다.
객체지향 프로그래밍은 하나의 아름다운 주인공을 만드는 것이 아니라 조화를 이루며 상호작용하는 객체를 창조하는 것이다.
협력을 객체를 역할, 책임, 협력의 관점으로 본다.

## 협력

하트 잭의 공판에서 다양한 사람들의 협력하여 재판이 진행된다.
주관자인 왕, 증언하는 모자 장수, 목격자를 부르는 토끼 등
다양한 협력 속에서 공판이 진행된다.

위 과정을 요청과 응답에 집중하여 공판 과정을 보면

* 누군가가 왕에게 재판을 `요청`함으로써 재판이 시작된다.
* 왕이 하얀 토끼에게 증인을 부를 것을 `요청`한다.
* 왕이 요청을 받은 토끼는 모자 장수에게 증인석으로 입장할 것을 `요청`한다.
* 모자 장수는 증인석에 입장함으로써 토끼의 요청에 `응답`한다.
* 모자 장수의 입장은 왕이 토끼에게 요청했던 증인 호출에 대한 `응답`이기도 하다.
* 이제 왕은 모자 장수에게 증언할 것을 `요청`한다. 
* 모자 장수는 자신이 알고 있는 내용을 증언함으로써 왕의 요청에 `응답`한다.

누군가가 왕에게 재판을 요청하고
왕은 토끼에게 목격자를 불러오게 요청하고
토끼는 모자 장수에게 입장을 요청하며 협력들이 이루어진다.

등장인물들이 특정한 요청을 받아들일 수 있는 이유는 그 요청에 대해 적절한 방식으로 응답하는 데 필요한 지식과 행동방식을 가지고 있기 때문이다.

## 책임

객체지향의 세계에서는 객체가 요청에 대답해 줄 수 있거나 적절한 행동을 할 의무가 있는 경우 `책임`을 가진다고 말한다.

앨리스 이야기의 왕은 '재판을 수행할' 책임을 지게 된다.
토끼는 '목격자를 불러올'책임을 진다.

대상에 대한 요청은 그 대상이 요청을 처리할 책임이 있음을 뜻한다.

### 책임의 분류

객체의 책임은 '객체가 무엇을 알고 있는가'와 '무엇을 할 수 있는가'로 구성된다.

하는 것
* 객체를 생성하거나 계산을 하는 등의 스스로 하는 것-1
* 다른 객체의 행동을 시작시키는 것-2
* 다른 객체의 활동을 제어하고 조절하는 것-3

아는 것
* 개인적인 정보에 관해 아는 것-4
* 관련된 객체에 관해 아는 것-5
* 자신이 유도하거나 계산할 수 있는 것에 관해 아는 것-6

왕은 토끼에게 목격자를 불러오도록 요청하고 모자 장수에게 증언을 요청한다(3).
왕은 하는 것과 관련된 책임을 수행한다.

토끼는 목격자가 모자장수인걸 알고 있으며(5) 모자 장수가 증인석에 입장하도록 한다(2).
토끼는 하는 것, 아는 것 두 가지를 수행한다.

모자 장수는 증인석에 스스로 입장을 하고(1) 알고 있는 사실을 증언한다(6).
모자 장수는 하는 것,아는 것 두 가지를 수행한다.

책임은 객체지향 설계의 품질을 결정하는 가장 중요한 요소다.
책임은 객체의 외부에 제공해 줄 수 있는 정보(아는 것)와 외부에 제공해 줄 수 있는 서비스(하는 것)의 목록이다.
공용 인터페이스를 구성한다.

### 책임과 메시지

협력에서 객체는 요청이 왔을 때 주어진 책임을 수행한다.
객체가 다른 객체에게 주어진 책임을 수행하도록 요청하는 것을 메시지 전송이라고 한다.
메시지는 협력을 위해 한 객체가 다른 객체로 접근할 수 있는 유일한 방법이다.

책임과 메시지의 수준은 같지 않다.
책임은 객체가 협력에 참여하기 위해 수행해야 하는 행위를 상위 수준에서 개략적으로 서술한 것이다.

## 역할

어떤 객체가 수행하는 책임의 집합은 객체가 협력 안에서 수행하는 역할을 암시한다.
역할은 재사용 가능하고 유연한 객체지향 설계를 낳는 매우 중요한 구성요소이다.

증언자는 모자 장수가 아니라 앨리스가 될 수 도 있다.
판사는 왕이 아니라 여왕이 될 수 도 있다.

역할은 협력 내에서 다른 객체로 대체할 수 있음을 나타내는 일종의 표식이다.
역할을 이용하여 협력을 추상화하여 판사 역할에는 왕과 여왕이
증인 역할에 앨리스와 모자 장수 등이 참여할 수 있다.
역할을 대체할 수 있는 객체는 동일한 메시지를 이해할 수 있는 객체로 한정된다.
동일한 역할을 수행하는 것은 동일한 책임의 집합을 수행함을 뜻한다.

역할은 객체지향 설계의 단순성, 유연성, 재사용성을 뒷받침해 주는 개념이다.

### 협력의 추상화

역할은 여러 객체가 협력에 참여할 수 있게 하여 협력을 추상화해준다.
협력의 추상화는 설계자가 다뤄야 하는 협력의 개수를 줄이는 동시에 구체적인 객체를 추상적인 역할로 대체함으로써 협력의 양상을 단순화 시킨다.

### 대체 가능성
객체가 역할을 대체하기 위해서는 행동이 호환돼야 한다.
주어진 책임 이외에 다른 책임도 수행할 수 있다.

## 객체의 모양을 결정하는 협력

### 흔한 오류

객체가 데이터를 저장하기 위해 존재한다는 선입견을 가지면 안 된다.
객체의 행동, 책임이 중요하다.

클래스와 클래스 간의 관계를 표현하는 시스템의 정적인 측면에 중점을 둬서는 안 된다.
클래스는 단지 시스템에 필요한 객체를 표현하고 생성하기 위한 구현 메커니즘이다.

### 협력을 따라 흐르는 객체의 책임

올바르게 객체를 설계하기 위해서는 먼저 견고하고 깔끔한 협력을 설계해야 한다.
설계에 참여하는 객체들이 주고받는 요청과 응답이  수행될 책임이 된다.
책임이 결정되면 그에 필요한 데이터를 고민하게 되고 이렇게 결정되면 클래스의 구현 방법을 결정해야 한다.
결과적으로 클래스와 데이터는 협력과 책임의 집합이 결정된 후에야 무대 위에 등장한다.
